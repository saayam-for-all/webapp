{"version":3,"file":"initializeInAppMessaging.js","sources":["../../../../../../src/inAppMessaging/providers/pinpoint/apis/initializeInAppMessaging.ts"],"sourcesContent":["\"use strict\";\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.initializeInAppMessaging = void 0;\nconst utils_1 = require(\"@aws-amplify/core/internals/utils\");\nconst core_1 = require(\"@aws-amplify/core\");\nconst eventListeners_1 = require(\"../../../../eventListeners\");\nconst helpers_1 = require(\"../utils/helpers\");\nconst types_1 = require(\"../types\");\nconst utils_2 = require(\"../utils\");\nconst utils_3 = require(\"../../../utils\");\nconst dispatchEvent_1 = require(\"./dispatchEvent\");\n/**\n * Initialize and set up in-app messaging category. This API needs to be called to enable other InAppMessaging APIs.\n *\n * @remarks\n * Make sure to call this early in your app at the root entry point after configuring Amplify.\n * @example\n * ```ts\n * Amplify.configure(config);\n * initializeInAppMessaging();\n * ```\n */\nfunction initializeInAppMessaging() {\n    if ((0, utils_3.isInitialized)()) {\n        return;\n    }\n    // register with the session listener\n    utils_1.sessionListener.addStateChangeListener(utils_2.sessionStateChangeHandler, true);\n    // wire up default Pinpoint message event handling\n    (0, eventListeners_1.addEventListener)('messageDisplayed', (message) => {\n        (0, helpers_1.recordAnalyticsEvent)(types_1.PinpointMessageEvent.MESSAGE_DISPLAYED, message);\n        (0, utils_2.incrementMessageCounts)(message.id);\n    });\n    (0, eventListeners_1.addEventListener)('messageDismissed', (message) => {\n        (0, helpers_1.recordAnalyticsEvent)(types_1.PinpointMessageEvent.MESSAGE_DISMISSED, message);\n    });\n    (0, eventListeners_1.addEventListener)('messageActionTaken', (message) => {\n        (0, helpers_1.recordAnalyticsEvent)(types_1.PinpointMessageEvent.MESSAGE_ACTION_TAKEN, message);\n    });\n    // listen to analytics hub events\n    core_1.Hub.listen('analytics', analyticsListener);\n    (0, utils_3.initialize)();\n}\nexports.initializeInAppMessaging = initializeInAppMessaging;\nfunction analyticsListener({ payload, }) {\n    const { event, data } = payload;\n    switch (event) {\n        case 'record': {\n            (0, dispatchEvent_1.dispatchEvent)(data);\n            break;\n        }\n        default:\n            break;\n    }\n}\n"],"names":[],"mappings":";;AACA;AACA;AACA,MAAM,CAAC,cAAc,CAAC,OAAO,EAAE,YAAY,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;AAC9D,OAAO,CAAC,wBAAwB,GAAG,KAAK,CAAC,CAAC;AAC1C,MAAM,OAAO,GAAG,OAAO,CAAC,mCAAmC,CAAC,CAAC;AAC7D,MAAM,MAAM,GAAG,OAAO,CAAC,mBAAmB,CAAC,CAAC;AAC5C,MAAM,gBAAgB,GAAG,OAAO,CAAC,4BAA4B,CAAC,CAAC;AAC/D,MAAM,SAAS,GAAG,OAAO,CAAC,kBAAkB,CAAC,CAAC;AAC9C,MAAM,OAAO,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACpC,MAAM,OAAO,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACpC,MAAM,OAAO,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAC;AAC1C,MAAM,eAAe,GAAG,OAAO,CAAC,iBAAiB,CAAC,CAAC;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,wBAAwB,GAAG;AACpC,IAAI,IAAI,IAAI,OAAO,CAAC,aAAa,GAAG,EAAE;AACtC,QAAQ,OAAO;AACf,KAAK;AACL;AACA,IAAI,OAAO,CAAC,eAAe,CAAC,sBAAsB,CAAC,OAAO,CAAC,yBAAyB,EAAE,IAAI,CAAC,CAAC;AAC5F;AACA,IAAI,IAAI,gBAAgB,CAAC,gBAAgB,EAAE,kBAAkB,EAAE,CAAC,OAAO,KAAK;AAC5E,QAAQ,IAAI,SAAS,CAAC,oBAAoB,EAAE,OAAO,CAAC,oBAAoB,CAAC,iBAAiB,EAAE,OAAO,CAAC,CAAC;AACrG,QAAQ,IAAI,OAAO,CAAC,sBAAsB,EAAE,OAAO,CAAC,EAAE,CAAC,CAAC;AACxD,KAAK,CAAC,CAAC;AACP,IAAI,IAAI,gBAAgB,CAAC,gBAAgB,EAAE,kBAAkB,EAAE,CAAC,OAAO,KAAK;AAC5E,QAAQ,IAAI,SAAS,CAAC,oBAAoB,EAAE,OAAO,CAAC,oBAAoB,CAAC,iBAAiB,EAAE,OAAO,CAAC,CAAC;AACrG,KAAK,CAAC,CAAC;AACP,IAAI,IAAI,gBAAgB,CAAC,gBAAgB,EAAE,oBAAoB,EAAE,CAAC,OAAO,KAAK;AAC9E,QAAQ,IAAI,SAAS,CAAC,oBAAoB,EAAE,OAAO,CAAC,oBAAoB,CAAC,oBAAoB,EAAE,OAAO,CAAC,CAAC;AACxG,KAAK,CAAC,CAAC;AACP;AACA,IAAI,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,WAAW,EAAE,iBAAiB,CAAC,CAAC;AACtD,IAAI,IAAI,OAAO,CAAC,UAAU,GAAG,CAAC;AAC9B,CAAC;AACD,OAAO,CAAC,wBAAwB,GAAG,wBAAwB,CAAC;AAC5D,SAAS,iBAAiB,CAAC,EAAE,OAAO,GAAG,EAAE;AACzC,IAAI,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,OAAO,CAAC;AACpC,IAAI,QAAQ,KAAK;AACjB,QAAQ,KAAK,QAAQ,EAAE;AACvB,YAAY,IAAI,eAAe,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;AACrD,YAAY,MAAM;AAClB,SAAS;AAGT,KAAK;AACL;;"}